# encoding: ascii-8bit

require 'seccomp-tools/disasm'

describe SeccompTools::Disasm do
  before do
    @bpf = IO.binread(File.join(__dir__, 'data', 'twctf-2016-diary.bpf'))
  end

  it 'normal' do
    expect(described_class.disasm(@bpf)).to eq <<EOS
 line  OP   JT   JF   K
=================================
 0000: 0x20 0x00 0x00 0x00000000
 0001: 0x15 0x00 0x01 0x00000002
 0002: 0x06 0x00 0x00 0x00000000
 0003: 0x15 0x00 0x01 0x00000101
 0004: 0x06 0x00 0x00 0x00000000
 0005: 0x15 0x00 0x01 0x0000003b
 0006: 0x06 0x00 0x00 0x00000000
 0007: 0x15 0x00 0x01 0x00000038
 0008: 0x06 0x00 0x00 0x00000000
 0009: 0x15 0x00 0x01 0x00000039
 0010: 0x06 0x00 0x00 0x00000000
 0011: 0x15 0x00 0x01 0x0000003a
 0012: 0x06 0x00 0x00 0x00000000
 0013: 0x15 0x00 0x01 0x00000055
 0014: 0x06 0x00 0x00 0x00000000
 0015: 0x15 0x00 0x01 0x00000142
 0016: 0x06 0x00 0x00 0x00000000
 0017: 0x06 0x00 0x00 0x7fff0000
EOS
  end
end
